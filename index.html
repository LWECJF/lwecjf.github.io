<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Joseph Fellowship</title>
    <style>
      table{font-size: 0.8em;font-family: "George";border-collapse: collapse;width: 100%;}
      .table th{color:#08c;}
      .table td, .table th{padding:8px;text-align:center;border:1px solid #333;}
      .table tr:hover{background: #F0F0F0;}
      .center{text-align:center;}
    </style>
    <script type="text/javascript" src="tabletop.min.js"></script>
    <script type="text/javascript">
      var public_spreadsheet_url = 'https://docs.google.com/spreadsheets/d/1HdaJt7PPO-GK0fgRCkOJjrnddszsLAGX_MbY6ai0gBs/pubhtml?gid=0&single=true';
      window.onload = function() { Tabletop.init( { key: public_spreadsheet_url, callback: function (data, tabletop) {createTableFromJSON(data, 'schedule');}, simpleSheet: true } ); };
      function createTableFromJSON(data, div_id) {
        var col = [];
        for (var i = 0; i < data.length; i++) {
            for (var key in data[i]) {
                if (col.indexOf(key) === -1) {
                    col.push(key);
                }
            }
        }
        var table = document.createElement("table");
        var tr = table.insertRow(-1);
        for (var i = 0; i < col.length; i++) {
            var th = document.createElement("th");
            th.innerHTML = col[i];
            tr.appendChild(th);
        }
        for (var i = 0; i < data.length; i++) {
            tr = table.insertRow(-1);
            for (var j = 0; j < col.length; j++) {
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = data[i][col[j]];
            }
        }
        var divContainer = document.getElementById(div_id);
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
      }
    </script>
  </head>
  <body>
    <h1 class="center">約瑟團契活動安排表</h1>
    <h4 class="center">歡迎訪問約瑟團契的主要網站<a href="https://jf.network" target="_blank">jf.network</a></h4>
    <div id="schedule" class="table"></div>
  </body>
</html>
